(this.webpackJsonpplaylister=this.webpackJsonpplaylister||[]).push([[0],{95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(36),c=n.n(i),s=n(10),o=n(37),l=n(72),u=n(124),d=n(97),j=n(33),b=n(125),f=n(126),O=n(25),h=n(73),p=n(131),g=n(127),v=n(28),x=n.n(v),m=n(64),y=n(38),S=n(30),T=n(6),D=function(e){var t=e.key,n=e.onRestore,r=e.setState,i=e.state;Object(a.useEffect)((function(){r(n(function(e){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(n){return window.localStorage.setItem(e,JSON.stringify({})),{}}return{}}(t)))}),[t,n,r]),Object(a.useEffect)((function(){!function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}(t,i)}),[t,i])},w=function(e){return Object.assign({},e)},C=n(129),k=n(2),E=function(e){var t=e.analyzing,n=e.onDrop;return Object(k.jsx)(C.a,{onDrop:n,progressMessage:t?"Analyzing ...":""})},A=window.MediaInfo,I=function(){return Math.random().toString(36).substr(2,9)},V=function(e){var t=e.results,n=e.setResults,r=Object(a.useState)(!1),i=Object(s.a)(r,2),c=i[0],o=i[1];D({key:"results",onRestore:w,setState:n,state:t});var l=Object(a.useCallback)((function(e){var t=function(e,t){return e.analyzeData((function(){return t.size}),function(e){return function(t,n){return new Promise((function(a,r){var i=new FileReader;i.onload=function(e){e.target.error&&r(e.target.error),a(new Uint8Array(e.target.result))},i.readAsArrayBuffer(e.slice(n,n+t))}))}}(t)).then((function(e){n((function(n){return Object(T.a)(Object(S.a)({},I(),Object(T.a)(Object(T.a)({},function(e){var t=e.media.track.filter((function(e){return"General"===e["@type"]}))[0];return{format:t.Format,duration:t.Duration,startTime:t.Encoded_Date}}(e)),{},{name:t.name})),n)}))})).catch((function(e){return n((function(n){return Object(T.a)(Object(S.a)({},I(),{name:t.name,error:e.stack}),n)}))})).finally((function(){return o(!1)}))};e&&(o(!0),A().then(function(){var n=Object(y.a)(x.a.mark((function n(a){var r,i,c;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=Object(m.a)(e),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=10;break}if(!(c=i.value)){n.next=8;break}return n.next=8,t(a,c);case 8:n.next=3;break;case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(1),r.e(n.t0);case 15:return n.prev=15,r.f(),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[1,12,15,18]])})));return function(e){return n.apply(this,arguments)}}()))}),[n]);return Object(k.jsx)(E,{analyzing:c,onDrop:l})},R=n(75),P=n(74),L=n(115),F=n(116),z=n(67),K="7px",N={TableBodyRow:{style:function(e){var t=e.$theme;return{backgroundColor:e.$rowIndex%2?t.colors.backgroundPrimary:t.colors.backgroundSecondary,":hover":{backgroundColor:t.colors.backgroundTertiary}}}},TableHeadCell:{style:function(e){e.$theme,e.$rowIndex;return{paddingLeft:K,paddingRight:K}}},TableBodyCell:{style:function(e){e.$theme,e.$rowIndex;return{paddingLeft:K,paddingRight:K,paddingTop:K,paddingBottom:K}}}},Y=function(e){var t=e.values,n=e.setValues,r=Object(a.useCallback)((function(e){return n((function(t){t[e];return Object(R.a)(t,[e].map(P.a))}))}),[n]),i=Object.entries(t).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return{id:n,name:a.name,format:a.format,startTime:a.startTime,duration:a.duration}})),c={TableHeadCell:{style:function(e){e.$theme,e.$rowIndex;return{textAlign:"right",paddingRight:K}}}};return Object(k.jsx)("div",{id:"results",children:Object(k.jsxs)(L.a,{data:i,overrides:N,children:[Object(k.jsx)(F.a,{header:"Name",children:function(e){return e.name}}),Object(k.jsx)(F.a,{header:"Format",children:function(e){return e.format}}),Object(k.jsx)(F.a,{header:"Start Time",children:function(e){return e.startTime}}),Object(k.jsx)(F.a,{header:"Duration",numeric:!0,overrides:c,children:function(e){return parseFloat(e.duration).toFixed(1).toString()+"s"}}),Object(k.jsx)(F.a,{header:"",children:function(e){return Object(k.jsx)("button",{className:"remove",onClick:function(t){t.stopPropagation(),r(e.id)},tabIndex:0,title:"Remove from list",type:"button",children:Object(k.jsx)(o.a,{icon:z.a,size:"lg"})})}})]})})},G=n(134),M=function(e){var t=e.value,n=e.setValue;return Object(k.jsx)("div",{children:Object(k.jsx)(G.a,{checked:t,onChange:function(e){return n(e.target.checked)},children:"Start times above are actually in local time zone"})})},$=n(12),B=n.n($),H=n(48),J=n.n(H),U=n(49),Z=n.n(U),_=n(50),X=n.n(_),q=n(51),Q=n.n(q),W=n(52),ee=n.n(W),te=n(117);B.a.extend(Z.a),B.a.extend(X.a),B.a.extend(ee.a),B.a.extend(Q.a),B.a.extend(J.a);var ne=function(e){var t=e.fileInfo,n=e.overrideTimeZone,r=e.startEndList,i=e.setStartEndList;Object(a.useEffect)((function(){var e=function(e,t){var a=function(e){if(n){var t=e.replace("UTC ","");return B()(t).local()}if(e.match("^UTC ")){var a=e.replace("UTC ","")+" +00:00";return B()(a,"YYYY-MM-DD HH:mm:ss Z").tz("UTC")}return B()(e)}(t.startTime),r=a.add(t.duration,"second");return{id:e,name:t.name,startTime:a.toISOString(),endTime:r.toISOString()}},a=Object.entries(t).flatMap((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1];return r.startTime?[e(a,r)]:[]})).sort((function(e,t){return e.startTime>t.startTime?1:-1}));i(a)}),[t,n,i]);var c="YYYY-MM-DD HH:mm:ss z";return Object(k.jsx)("div",{id:"start-end",children:Object(k.jsx)(te.a,{columns:["Name","Start Time","End Time"],overrides:N,data:r.map((function(e){return[e.name,B()(e.startTime).format(c),B()(e.endTime).format(c)]}))})})},ae=n(24),re=n(68),ie=n(135),ce=function(e){var t=e.children,n=e.title;return Object(k.jsx)(ie.a,{overrides:{Root:{style:function(e){e.$theme;return{marginTop:"20px",marginBottom:"20px"}}},Title:{style:function(e){var t=e.$theme;return Object(T.a)({},t.typography.HeadingXSmall)}}},title:n,children:t})},se=function(e){var t=new Set;return e.map((function(e){return B()(e.startTime).format("YYYYMMDD")})).forEach((function(e){return t.add(e)})),t.size>0?t.values().next().value:""},oe=function(e){var t=e.startEndList,n=e.value,r=e.setValue;return Object(a.useEffect)((function(){r(Object(T.a)(Object(T.a)({},n),{},{date:se(t)}))}),[t]),Object(k.jsx)(ce,{title:"Inferred Date",children:Object(k.jsx)("label",{children:n.date})})},le=function(e){var t=e.startEndList,n=e.setStartEndList,r=(e.rehearsalData,e.setRehearsalData,e.inferredDate),i=e.setInferredDate,c=Object(a.useState)({}),o=Object(s.a)(c,2),l=o[0],u=o[1],d=Object(a.useState)(!0),j=Object(s.a)(d,2),b=j[0],f=j[1];return Object(k.jsxs)("div",{children:[Object(k.jsx)(V,{results:l,setResults:u}),Object(k.jsxs)(re.b,{children:[Object(k.jsxs)(ce,{title:"File Metadata",children:[Object(k.jsx)(Y,{values:l,setValues:u}),Object(k.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:Object(k.jsx)(ae.a,{onClick:function(){return u({})},children:"Clear All"})})]}),Object(k.jsxs)(ce,{title:"Start and End Times",children:[Object(k.jsx)(M,{value:b,setValue:f}),Object(k.jsx)(ne,{fileInfo:l,overrideTimeZone:b,startEndList:t,setStartEndList:n})]}),Object(k.jsx)(oe,{startEndList:t,value:r,setValue:i})]})]})},ue=n(118),de=n(130),je=n(132),be=n(7),fe=n(133),Oe=n(13),he=window.gapi,pe=function(e){var t=e.googleAuth,n=e.setGoogleAuth,r=Object(a.useState)({apiKey:"",clientId:""}),i=Object(s.a)(r,2),c=i[0],o=i[1],l=Object(a.useState)({}),u=Object(s.a)(l,2),d=u[0],j=u[1];D({key:"apiData",onRestore:w,setState:o,state:c});var b=function(){return t&&t.isSignedIn};return Object(k.jsxs)(re.b,{children:[Object(k.jsx)(ue.a,{styleLevel:6,children:"API Key"}),Object(k.jsx)(de.a,{value:c.apiKey,onChange:function(e){return o(Object(T.a)(Object(T.a)({},c),{},{apiKey:e.target.value}))}}),Object(k.jsx)(ue.a,{styleLevel:6,children:"Client ID"}),Object(k.jsx)(de.a,{value:c.clientId,onChange:function(e){return o(Object(T.a)(Object(T.a)({},c),{},{clientId:e.target.value}))}}),Object(k.jsxs)("div",{style:{marginTop:"20px"},children:[Object(k.jsx)(je.a,{onClick:function(){var e;e=function(){var e=Object(y.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/youtube.force-ssl"}).then((function(){return console.log("Sign-in successful")}),(function(e){var t="Error signing in";console.error(t,e),j({error:t})}));case 2:return e.next=4,he.client.setApiKey(c.apiKey),he.client.load("https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest").then((function(){return console.log("GAPI client loaded for API")}),(function(e){var t="Error loading GAPI client for API";console.error(t,e),j({error:t})}));case 4:n(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he.load("client:auth2",(function(){return he.auth2.init({client_id:c.clientId}).then((function(t){e(t)}))}))},kind:b()?be.a.secondary:be.a.primary,children:"Authenticate"}),b()?Object(k.jsx)(fe.a,{kind:Oe.a.positive,closeable:!0,children:"\u2705 Authenticated"}):d.error?Object(k.jsx)(fe.a,{kind:Oe.a.negative,closeable:!0,children:d.error}):null]})]})},ge=n(137),ve=n(128),xe=n(136),me=n(119),ye=function(e){var t=e.inferredDate,n=e.value,a=e.setValue;return Object(k.jsx)(ce,{title:"Rehearsal Data",children:Object(k.jsxs)(xe.a,{flexGridColumnCount:2,flexGridColumnGap:"scale800",flexGridRowGap:"scale800",children:[Object(k.jsx)(me.a,{children:Object(k.jsx)(ge.a,{label:"inferred date",children:Object(k.jsx)(de.a,{disabled:!0,value:t.date||""})})}),Object(k.jsx)(me.a,{children:Object(k.jsx)(ge.a,{label:"event type",children:Object(k.jsx)(ve.a,{value:n.eventType,onChange:function(e){return a(Object(T.a)(Object(T.a)({},n),{},{eventType:e}))},options:["rehearsal","coaching"],mapOptionToString:function(e){return e}})})})]})})},Se=n(120),Te=n(121),De=n(122),we=function(e){var t=e.inferredDate,n=e.rehearsalData,r=e.value,i=e.setValue;return Object(a.useEffect)((function(){i(Object(T.a)(Object(T.a)({},r),{},{suggestedTitle:"".concat(t.date," ").concat(n.eventType)}))}),[n]),Object(k.jsxs)(ce,{title:"Playlist Title",children:[Object(k.jsxs)(Se.a,{value:r.titleChoice,onChange:function(e){return i(Object(T.a)(Object(T.a)({},r),{},{titleChoice:e.currentTarget.value}))},name:"titleChoice",align:Te.a.horizontal,children:[Object(k.jsx)(De.a,{value:"suggested",children:"Suggested \xa0"}),Object(k.jsx)(De.a,{value:"custom",children:"Custom"})]}),Object(k.jsx)(de.a,{value:"suggested"===r.titleChoice?r.suggestedTitle||"":r.customTitle||"",onChange:function(e){return"custom"===r.titleChoice?i(Object(T.a)(Object(T.a)({},r),{},{customTitle:e.target.value})):null},disabled:"custom"!==r.titleChoice})]})},Ce=window.gapi,ke=function(e){var t=e.googleAuth,n=e.rehearsalData,i=e.setRehearsalData,c=e.inferredDate,o=e.setActiveKey,l=e.value,u=e.setValue,d=Object(a.useState)({message:""}),j=Object(s.a)(d,2),b=j[0],f=j[1],O=Object(a.useState)({titleChoice:"suggested"}),h=Object(s.a)(O,2),p=h[0],g=h[1],v=function(){var e=c.date||"",t=n.eventType;return e&&t?e.replaceAll("-","")+" "+t:""},x=function(e,t){var n=e.items.filter((function(e){return e.snippet.title===t}));return n&&n[0]?n[0]:null},m=function(e){return console.log("storePlaylist: playlist = ",e),e.hasOwnProperty(["id"])?u(Object(T.a)(Object(T.a)({},l),{},{id:e.id,title:e.snippet.title,itemCount:e.contentDetails.itemCount,publishedAt:e.snippet.publishedAt,description:e.snippet.description})):u({})};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={part:["snippet,contentDetails"],maxResults:50,mine:!0},n="custom"===p.titleChoice?p.customTitle:v();return""!==e&&(t.pageToken=e),Ce.client.youtube.playlists.list(t).then((function(e){var t=x(e.result,n);t?(console.log("found matching playlist",t),m(t),f(Object(T.a)(Object(T.a)({},b),{},{message:'Found existing playlist "'.concat(t.snippet.title,'"'),isError:!1}))):e.result.nextPageToken?y(e.result.nextPageToken):S(n)}),(function(e){return console.error("Execute error",e)}))}function S(e){var t={part:["snippet,contentDetails,status"],resource:{snippet:{title:e,description:"created by playlister on ".concat(B()())},status:{privacyStatus:"unlisted"}}};return console.log("insertPlaylist: inserting playlist with props",t),Ce.client.youtube.playlists.insert(t).then((function(e){var t=e.result;console.log("insertPlaylist: playlist = ",t),m(t),f(Object(T.a)(Object(T.a)({},b),{},{message:'Created playlist "'.concat(e.result.snippet.title,'"'),isError:!1}))}),(function(e){console.error("Execute error",e),m({}),f(Object(T.a)(Object(T.a)({},b),{},{message:"Error creating playlist: ".concat(JSON.stringify(e)),isError:!0}))}))}var D=function(){return t&&t.isSignedIn};return Object(k.jsxs)(r.a.Fragment,{children:[Object(k.jsx)(ye,{inferredDate:c,value:n,setValue:i}),Object(k.jsx)(we,{inferredDate:c,rehearsalData:n,value:p,setValue:g}),Object(k.jsx)(je.a,{onClick:function(){return y()},kind:l.id?be.a.secondary:be.a.primary,disabled:!D(),children:"Find or Create Playlist"}),function(){if(D()){if(b.message){var e=b.isError?Oe.a.negative:Oe.a.positive;return Object(k.jsx)(fe.a,{kind:e,overrides:{Body:{style:{width:"auto"}}},closeable:!0,children:b.message})}return null}return Object(k.jsxs)(fe.a,{kind:Oe.a.negative,overrides:{Body:{style:{width:"auto"}}},children:["Please \xa0",Object(k.jsx)(ae.a,{onClick:function(){return o(1)},children:"authenticate"}),"\xa0 first"]})}(),function(){if(l.id){var e=[["title",l.title],["description",l.description],["id",l.id],["item count",l.itemCount],["published at",l.publishedAt]];return Object(k.jsx)(ce,{title:"Playlist",children:Object(k.jsx)(te.a,{data:e,columns:["Field","Value"]})})}return null}()]})},Ee=n(70),Ae=n(123),Ie=function(e){var t=e.value,n=e.setValue;return Object(k.jsx)(ce,{title:"Video Naming",children:Object(k.jsxs)(Ee.b,{children:[Object(k.jsx)(Ae.a,{span:[1,2,2],children:Object(k.jsx)(ge.a,{label:"prefix",children:Object(k.jsx)(de.a,{value:t.prefix,onChange:function(e){return n(Object(T.a)(Object(T.a)({},t),{},{prefix:e.target.value}))}})})}),Object(k.jsx)(Ae.a,{span:[2,3,4],children:Object(k.jsx)(ge.a,{label:"camera view",children:Object(k.jsx)(ve.a,{value:t.cameraView,onChange:function(e){return n(Object(T.a)(Object(T.a)({},t),{},{cameraView:e}))},options:["chorus","director","corner","elevated"],mapOptionToString:function(e){return e}})})})]})})};B.a.extend(Z.a),B.a.extend(X.a),B.a.extend(ee.a),B.a.extend(Q.a),B.a.extend(J.a);var Ve=function(e){var t=e.inferredDate,n=e.startEndList,r=e.playlistSettings,i=e.videoNameSettings,c=(e.videoResources,e.setVideoResources),o=Object(a.useState)([]),l=Object(s.a)(o,2),u=l[0],d=l[1];Object(a.useEffect)((function(){var e=t.date,a=r.itemCount+1,s=n.map((function(t,n){return{kind:"youtube#video",snippet:{title:"".concat(i.prefix," ").concat(e," ").concat(i.cameraView," ").concat((r=a+n,r<10?"0".concat(r):"".concat(r))),categoryId:10},recordingDetails:{recordingDate:B()(t.startTime).utc().format()}};var r}));c(s),d(n.map((function(e){return e.name})).map((function(e,t){return[e,s[t].snippet.title,s[t].recordingDetails.recordingDate]})))}),[n,r,i]);return Object(k.jsx)(ce,{title:"Video List",children:Object(k.jsx)(te.a,{columns:["File name","Video Name","Recording Date"],data:u})})},Re=(window.gapi,function(e){var t=e.googleAuth,n=e.inferredDate,i=e.startEndList,c=e.playlistSettings,o=e.setActiveKey,l=Object(a.useState)({prefix:"fcs",cameraView:"chorus"}),u=Object(s.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)({}),f=Object(s.a)(b,2),O=f[0],h=f[1],p=function(){return t&&t.isSignedIn};return Object(k.jsxs)(r.a.Fragment,{children:[Object(k.jsx)(Ie,{value:d,setValue:j}),Object(k.jsx)(Ve,{inferredDate:n,startEndList:i,playlistSettings:c,videoNameSettings:d,videoResources:O,setVideoResources:h}),Object(k.jsx)(je.a,{disabled:!(p()&&Object.keys(O).length>0&&c.id),children:"Upload not work yet"}),function(){var e={Body:{style:{width:"auto"}}};return p()?c.id?null:Object(k.jsxs)(fe.a,{kind:Oe.a.negative,overrides:e,children:["Please \xa0",Object(k.jsx)(ae.a,{onClick:function(){return o(2)},children:"find or create the playlist"}),"\xa0 first"]}):Object(k.jsxs)(fe.a,{kind:Oe.a.negative,overrides:e,children:["Please \xa0",Object(k.jsx)(ae.a,{onClick:function(){return o(1)},children:"authenticate"}),"\xa0 first"]})}()]})}),Pe=new h.a;var Le=function(){var e=Object(a.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),c=Object(s.a)(i,2),h=c[0],v=c[1],x=Object(a.useState)(),m=Object(s.a)(x,2),y=m[0],S=m[1],T=Object(a.useState)({eventType:"rehearsal"}),D=Object(s.a)(T,2),w=D[0],C=D[1],E=Object(a.useState)({}),A=Object(s.a)(E,2),I=A[0],V=A[1],R=Object(a.useState)({}),P=Object(s.a)(R,2),L=P[0],F=P[1];return Object(k.jsx)(O.a,{value:Pe,children:Object(k.jsx)(u.a,{theme:d.a,children:Object(k.jsxs)(j.b,{theme:Object(b.a)(f.a,{colors:{inputTextDisabled:"black"}}),children:[Object(k.jsx)(re.b,{children:Object(k.jsxs)(p.a,{activeKey:n,onChange:function(e){var t=e.activeKey;return r(t)},children:[Object(k.jsx)(g.a,{title:"Files",children:Object(k.jsx)(le,{startEndList:h,setStartEndList:v,rehearsalData:w,setRehearsalData:C,inferredDate:L,setInferredDate:F})}),Object(k.jsx)(g.a,{title:"Auth",children:Object(k.jsx)(pe,{googleAuth:y,setGoogleAuth:S})}),Object(k.jsx)(g.a,{title:"Playlist",children:Object(k.jsx)(ke,{googleAuth:y,startEndList:h,rehearsalData:w,setRehearsalData:C,inferredDate:L,setActiveKey:r,value:I,setValue:V})}),Object(k.jsx)(g.a,{title:"Videos",children:Object(k.jsx)(Re,{googleAuth:y,inferredDate:L,startEndList:h,playlistSettings:I,setActiveKey:r})})]})}),Object(k.jsx)("footer",{children:Object(k.jsx)("p",{children:Object(k.jsxs)("a",{href:"https://github.com/kamatsuoka/playlister",children:[Object(k.jsx)(o.a,{className:"fa-padded",icon:l.a,size:"lg"}),"GitHub"]})})})]})})})};n(95);c.a.render(Object(k.jsx)(Le,{}),document.getElementById("root"))}},[[96,1,2]]]);
//# sourceMappingURL=main.1f21bad9.chunk.js.map