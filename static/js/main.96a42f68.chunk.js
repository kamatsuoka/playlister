(this.webpackJsonpplaylister=this.webpackJsonpplaylister||[]).push([[0],{95:function(e,t,n){},96:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(36),c=n.n(i),s=n(10),l=n(37),o=n(72),u=n(124),d=n(97),j=n(33),b=n(125),f=n(126),O=n(25),h=n(73),x=n(131),p=n(127),v=n(28),m=n.n(v),g=n(64),y=n(38),T=n(30),S=n(6),C=function(e){var t=e.key,n=e.onRestore,r=e.setState,i=e.state;Object(a.useEffect)((function(){r(n(function(e){var t=window.localStorage.getItem(e);if(t)try{return JSON.parse(t)}catch(n){return window.localStorage.setItem(e,JSON.stringify({})),{}}return{}}(t)))}),[t,n,r]),Object(a.useEffect)((function(){!function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}(t,i)}),[t,i])},D=function(e){return Object.assign({},e)},k=n(129),w=n(2),E=function(e){var t=e.analyzing,n=e.onDrop;return Object(w.jsx)(k.a,{onDrop:n,progressMessage:t?"Analyzing ...":""})},I=window.MediaInfo,A=function(){return Math.random().toString(36).substr(2,9)},V=function(e){var t=e.results,n=e.setResults,r=Object(a.useState)(!1),i=Object(s.a)(r,2),c=i[0],l=i[1];C({key:"results",onRestore:D,setState:n,state:t});var o=Object(a.useCallback)((function(e){var t=function(e,t){return e.analyzeData((function(){return t.size}),function(e){return function(t,n){return new Promise((function(a,r){var i=new FileReader;i.onload=function(e){e.target.error&&r(e.target.error),a(new Uint8Array(e.target.result))},i.readAsArrayBuffer(e.slice(n,n+t))}))}}(t)).then((function(e){n((function(n){return Object(S.a)(Object(T.a)({},A(),Object(S.a)(Object(S.a)({},function(e){var t=e.media.track.filter((function(e){return"General"===e["@type"]}))[0];return{format:t.Format,duration:t.Duration,startTime:t.Encoded_Date}}(e)),{},{name:t.name})),n)}))})).catch((function(e){return n((function(n){return Object(S.a)(Object(T.a)({},A(),{name:t.name,error:e.stack}),n)}))})).finally((function(){return l(!1)}))};e&&(l(!0),I().then(function(){var n=Object(y.a)(m.a.mark((function n(a){var r,i,c;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r=Object(g.a)(e),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=10;break}if(!(c=i.value)){n.next=8;break}return n.next=8,t(a,c);case 8:n.next=3;break;case 10:n.next=15;break;case 12:n.prev=12,n.t0=n.catch(1),r.e(n.t0);case 15:return n.prev=15,r.f(),n.finish(15);case 18:case"end":return n.stop()}}),n,null,[[1,12,15,18]])})));return function(e){return n.apply(this,arguments)}}()))}),[n]);return Object(w.jsx)(E,{analyzing:c,onDrop:o})},R=n(75),L=n(74),P=n(115),F=n(116),z=n(67),K="7px",N={TableBodyRow:{style:function(e){var t=e.$theme;return{backgroundColor:e.$rowIndex%2?t.colors.backgroundPrimary:t.colors.backgroundSecondary,":hover":{backgroundColor:t.colors.backgroundTertiary}}}},TableHeadCell:{style:function(e){e.$theme,e.$rowIndex;return{paddingLeft:K,paddingRight:K}}},TableBodyCell:{style:function(e){e.$theme,e.$rowIndex;return{paddingLeft:K,paddingRight:K,paddingTop:K,paddingBottom:K}}}},Y=function(e){var t=e.values,n=e.setValues,r=Object(a.useCallback)((function(e){return n((function(t){t[e];return Object(R.a)(t,[e].map(L.a))}))}),[n]),i=Object.entries(t).map((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];return{id:n,name:a.name,format:a.format,startTime:a.startTime,duration:a.duration}})),c={TableHeadCell:{style:function(e){e.$theme,e.$rowIndex;return{textAlign:"right",paddingRight:K}}}};return Object(w.jsx)("div",{id:"results",children:Object(w.jsxs)(P.a,{data:i,overrides:N,children:[Object(w.jsx)(F.a,{header:"Name",children:function(e){return e.name}}),Object(w.jsx)(F.a,{header:"Format",children:function(e){return e.format}}),Object(w.jsx)(F.a,{header:"Start Time",children:function(e){return e.startTime}}),Object(w.jsx)(F.a,{header:"Duration",numeric:!0,overrides:c,children:function(e){return parseFloat(e.duration).toFixed(1).toString()+"s"}}),Object(w.jsx)(F.a,{header:"",children:function(e){return Object(w.jsx)("button",{className:"remove",onClick:function(t){t.stopPropagation(),r(e.id)},tabIndex:0,title:"Remove from list",type:"button",children:Object(w.jsx)(l.a,{icon:z.a,size:"lg"})})}})]})})},M=n(134),$=function(e){var t=e.value,n=e.setValue;return Object(w.jsx)("div",{children:Object(w.jsx)(M.a,{checked:t,onChange:function(e){return n(e.target.checked)},children:"Start times above are actually in local time zone"})})},B=n(12),G=n.n(B),H=n(48),J=n.n(H),U=n(49),Z=n.n(U),_=n(50),X=n.n(_),q=n(51),Q=n.n(q),W=n(52),ee=n.n(W),te=n(117);G.a.extend(Z.a),G.a.extend(X.a),G.a.extend(ee.a),G.a.extend(Q.a),G.a.extend(J.a);var ne=function(e){var t=e.fileInfo,n=e.overrideTimeZone,r=e.startEndList,i=e.setStartEndList;Object(a.useEffect)((function(){var e=function(e,t){var a=function(e){if(n){var t=e.replace("UTC ","");return G()(t).local()}if(e.match("^UTC ")){var a=e.replace("UTC ","")+" +00:00";return G()(a,"YYYY-MM-DD HH:mm:ss Z").tz("UTC")}return G()(e)}(t.startTime),r=a.add(t.duration,"second");return{id:e,name:t.name,startTime:a.toISOString(),endTime:r.toISOString()}},a=Object.entries(t).flatMap((function(t){var n=Object(s.a)(t,2),a=n[0],r=n[1];return r.startTime?[e(a,r)]:[]})).sort((function(e,t){return e.startTime>t.startTime?1:-1}));i(a)}),[t,n,i]);var c="YYYY-MM-DD HH:mm:ss z";return Object(w.jsx)("div",{id:"start-end",children:Object(w.jsx)(te.a,{columns:["Name","Start Time","End Time"],overrides:N,data:r.map((function(e){return[e.name,G()(e.startTime).format(c),G()(e.endTime).format(c)]}))})})},ae=n(24),re=n(68),ie=n(135),ce=function(e){var t=e.children,n=e.title;return Object(w.jsx)(ie.a,{overrides:{Root:{style:function(e){e.$theme;return{marginTop:"20px",marginBottom:"20px"}}},Title:{style:function(e){var t=e.$theme;return Object(S.a)({},t.typography.HeadingXSmall)}}},title:n,children:t})},se=function(e){var t=new Set;return e.map((function(e){return G()(e.startTime).format("YYYYMMDD")})).forEach((function(e){return t.add(e)})),t.size>0?t.values().next().value:""},le=function(e){var t=e.startEndList,n=e.value,r=e.setValue;return Object(a.useEffect)((function(){r(Object(S.a)(Object(S.a)({},n),{},{date:se(t)}))}),[t]),Object(w.jsx)(ce,{title:"Inferred Date",children:Object(w.jsx)("label",{children:n.date})})},oe=function(e){var t=e.startEndList,n=e.setStartEndList,r=(e.rehearsalData,e.setRehearsalData,e.inferredDate),i=e.setInferredDate,c=Object(a.useState)({}),l=Object(s.a)(c,2),o=l[0],u=l[1],d=Object(a.useState)(!0),j=Object(s.a)(d,2),b=j[0],f=j[1];return Object(w.jsxs)("div",{children:[Object(w.jsx)(V,{results:o,setResults:u}),Object(w.jsxs)(re.b,{children:[Object(w.jsxs)(ce,{title:"File Metadata",children:[Object(w.jsx)(Y,{values:o,setValues:u}),Object(w.jsx)("div",{style:{textAlign:"right",marginTop:"10px"},children:Object(w.jsx)(ae.a,{onClick:function(){return u({})},children:"Clear All"})})]}),Object(w.jsxs)(ce,{title:"Start and End Times",children:[Object(w.jsx)($,{value:b,setValue:f}),Object(w.jsx)(ne,{fileInfo:o,overrideTimeZone:b,startEndList:t,setStartEndList:n})]}),Object(w.jsx)(le,{startEndList:t,value:r,setValue:i})]})]})},ue=n(118),de=n(130),je=n(132),be=n(7),fe=n(133),Oe=n(13),he=window.gapi,xe=function(){try{if(he.auth2){var e=he.auth2.getAuthInstance();return e&&e.isSignedIn.get()}}catch(t){console.error(t)}return!1},pe=function(){var e=Object(a.useState)({apiKey:"",clientId:""}),t=Object(s.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)({}),c=Object(s.a)(i,2),l=c[0],o=c[1];C({key:"apiData",onRestore:D,setState:r,state:n});return Object(w.jsxs)(re.b,{children:[Object(w.jsx)(ue.a,{styleLevel:6,children:"API Key"}),Object(w.jsx)(de.a,{value:n.apiKey,onChange:function(e){return r(Object(S.a)(Object(S.a)({},n),{},{apiKey:e.target.value}))}}),Object(w.jsx)(ue.a,{styleLevel:6,children:"Client ID"}),Object(w.jsx)(de.a,{value:n.clientId,onChange:function(e){return r(Object(S.a)(Object(S.a)({},n),{},{clientId:e.target.value}))}}),Object(w.jsxs)("div",{style:{marginTop:"20px"},children:[Object(w.jsx)(je.a,{onClick:function(){var e;e=Object(y.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he.auth2.getAuthInstance().signIn({scope:"https://www.googleapis.com/auth/youtube.force-ssl"}).then((function(){return console.log("Sign-in successful")}),(function(e){var t="Error signing in";console.error(t,e),o({error:t})}));case 2:return e.next=4,he.client.setApiKey(n.apiKey),he.client.load("https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest").then((function(){return console.log("GAPI client loaded for API")}),(function(e){var t="Error loading GAPI client for API";console.error(t,e),o({error:t})}));case 4:o({message:"\u2705 Authenticated"});case 5:case"end":return e.stop()}}),e)}))),he.load("client:auth2",(function(){return he.auth2.init({client_id:n.clientId}).then((function(t){e(t)}))}))},kind:xe()?be.a.secondary:be.a.primary,children:"Authenticate"}),l.message?Object(w.jsx)(fe.a,{kind:Oe.a.positive,closeable:!0,children:l.message}):l.error?Object(w.jsx)(fe.a,{kind:Oe.a.negative,closeable:!0,children:l.error}):void 0]})]})},ve=n(137),me=n(128),ge=n(136),ye=n(119),Te=function(e){var t=e.inferredDate,n=e.value,a=e.setValue;return Object(w.jsx)(ce,{title:"Rehearsal Data",children:Object(w.jsxs)(ge.a,{flexGridColumnCount:2,flexGridColumnGap:"scale800",flexGridRowGap:"scale800",children:[Object(w.jsx)(ye.a,{children:Object(w.jsx)(ve.a,{label:"inferred date",children:Object(w.jsx)(de.a,{disabled:!0,value:t.date||""})})}),Object(w.jsx)(ye.a,{children:Object(w.jsx)(ve.a,{label:"event type",children:Object(w.jsx)(me.a,{value:n.eventType,onChange:function(e){return a(Object(S.a)(Object(S.a)({},n),{},{eventType:e}))},options:["rehearsal","coaching"],mapOptionToString:function(e){return e}})})})]})})},Se=n(120),Ce=n(121),De=n(122),ke=function(e){var t=e.inferredDate,n=e.rehearsalData,r=e.value,i=e.setValue;return Object(a.useEffect)((function(){i(Object(S.a)(Object(S.a)({},r),{},{suggestedTitle:"".concat(t.date," ").concat(n.eventType)}))}),[n]),Object(w.jsxs)(ce,{title:"Playlist Title",children:[Object(w.jsxs)(Se.a,{value:r.titleChoice,onChange:function(e){return i(Object(S.a)(Object(S.a)({},r),{},{titleChoice:e.currentTarget.value}))},name:"titleChoice",align:Ce.a.horizontal,children:[Object(w.jsx)(De.a,{value:"suggested",children:"Suggested \xa0"}),Object(w.jsx)(De.a,{value:"custom",children:"Custom"})]}),Object(w.jsx)(de.a,{value:"suggested"===r.titleChoice?r.suggestedTitle||"":r.customTitle||"",onChange:function(e){return"custom"===r.titleChoice?i(Object(S.a)(Object(S.a)({},r),{},{customTitle:e.target.value})):null},disabled:"custom"!==r.titleChoice})]})},we=function(e){var t=e.rehearsalData,n=e.setRehearsalData,i=e.inferredDate,c=e.setActiveKey,l=e.playlistTitle,o=e.setPlaylistTitle,u=e.value,d=e.setValue,j=Object(a.useState)({message:""}),b=Object(s.a)(j,2),f=b[0],O=b[1],h=function(){var e=i.date||"",n=t.eventType;return e&&n?e.replaceAll("-","")+" "+n:""},x=function(e,t){var n=e.items.filter((function(e){return e.snippet.title===t}));return n&&n[0]?n[0]:null},p=function(e){return e.hasOwnProperty(["id"])?d(Object(S.a)(Object(S.a)({},u),{},{id:e.id,title:e.snippet.title,itemCount:e.contentDetails.itemCount,publishedAt:e.snippet.publishedAt,description:e.snippet.description})):d({})};function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={part:["snippet,contentDetails"],maxResults:50,mine:!0},n="custom"===l.titleChoice?l.customTitle:h();return""!==e&&(t.pageToken=e),he.client.youtube.playlists.list(t).then((function(e){var t=x(e.result,n);t?(p(t),O(Object(S.a)(Object(S.a)({},f),{},{message:'Found existing playlist "'.concat(t.snippet.title,'"'),isError:!1}))):e.result.nextPageToken?v(e.result.nextPageToken):m(n)}),(function(e){return console.error("Execute error",e)}))}function m(e){var t={part:["snippet,contentDetails,status"],resource:{snippet:{title:e,description:"created by playlister on ".concat(G()())},status:{privacyStatus:"unlisted"}}};return he.client.youtube.playlists.insert(t).then((function(e){var t=e.result;p(t),O(Object(S.a)(Object(S.a)({},f),{},{message:'Created playlist "'.concat(e.result.snippet.title,'"'),isError:!1}))}),(function(e){console.error("Execute error",e),p({}),O(Object(S.a)(Object(S.a)({},f),{},{message:"Error creating playlist: ".concat(JSON.stringify(e)),isError:!0}))}))}return Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(Te,{inferredDate:i,value:t,setValue:n}),Object(w.jsx)(ke,{inferredDate:i,rehearsalData:t,value:l,setValue:o}),Object(w.jsx)(je.a,{onClick:function(){return v()},kind:u.id?be.a.secondary:be.a.primary,disabled:!xe(),children:"Find or Create Playlist"}),function(){if(xe()){if(f.message){var e=f.isError?Oe.a.negative:Oe.a.positive;return Object(w.jsx)(fe.a,{kind:e,overrides:{Body:{style:{width:"auto"}}},closeable:!0,children:f.message})}return null}return Object(w.jsxs)(fe.a,{kind:Oe.a.negative,overrides:{Body:{style:{width:"auto"}}},children:["Please \xa0",Object(w.jsx)(ae.a,{onClick:function(){return c(1)},children:"authenticate"}),"\xa0 first"]})}(),function(){if(u.id){var e=[["title",u.title],["description",u.description],["id",u.id],["item count",u.itemCount],["published at",u.publishedAt]];return Object(w.jsx)(ce,{title:"Playlist",children:Object(w.jsx)(te.a,{data:e,columns:["Field","Value"]})})}return null}()]})},Ee=n(70),Ie=n(123),Ae=function(e){var t=e.playlistSettings,n=e.value,a=e.setValue;return Object(w.jsx)(ce,{title:"Video Naming",children:Object(w.jsxs)(Ee.b,{children:[Object(w.jsx)(Ie.a,{span:[1,2,2],children:Object(w.jsx)(ve.a,{label:"prefix",children:Object(w.jsx)(de.a,{value:n.prefix,onChange:function(e){return a(Object(S.a)(Object(S.a)({},n),{},{prefix:e.target.value}))}})})}),Object(w.jsx)(Ie.a,{span:[2,3,4],children:Object(w.jsx)(ve.a,{label:"camera view",children:Object(w.jsx)(me.a,{value:n.cameraView,onChange:function(e){return a(Object(S.a)(Object(S.a)({},n),{},{cameraView:e}))},options:["chorus","director","corner","elevated"],mapOptionToString:function(e){return e}})})}),Object(w.jsx)(Ie.a,{span:[1,2,2],children:Object(w.jsx)(ve.a,{label:"next index",children:Object(w.jsx)(de.a,{value:(t.itemCount||0)+1,type:"number",disabled:!0})})}),Object(w.jsx)(Ie.a,{span:[1,2,2],children:Object(w.jsx)(ve.a,{label:"index offset",children:Object(w.jsx)(de.a,{value:n.indexOffset,type:"number",min:-(t.itemCount||0),onChange:function(e){return a(Object(S.a)(Object(S.a)({},n),{},{indexOffset:e.target.value}))}})})})]})})};G.a.extend(Z.a),G.a.extend(X.a),G.a.extend(ee.a),G.a.extend(Q.a),G.a.extend(J.a);var Ve=function(e){var t=e.inferredDate,n=e.startEndList,r=e.playlistSettings,i=e.videoNaming,c=e.setVideoResources,l=Object(a.useState)([]),o=Object(s.a)(l,2),u=o[0],d=o[1];Object(a.useEffect)((function(){var e=t.date,a=parseInt(r.itemCount||0)+1+parseInt(i.indexOffset),s=n.map((function(t,n){return{kind:"youtube#video",snippet:{title:"".concat(i.prefix," ").concat(e," ").concat(i.cameraView," ").concat((r=a+n,r<10?"0".concat(r):"".concat(r))),categoryId:10},recordingDetails:{recordingDate:G()(t.startTime).utc().format()}};var r}));c(s),d(n.map((function(e){return e.name})).map((function(e,t){return[e,s[t].snippet.title,s[t].recordingDetails.recordingDate]})))}),[n,r,i]);return Object(w.jsx)(ce,{title:"Video List",children:Object(w.jsx)(te.a,{columns:["File name","Video Name","Recording Date"],data:u})})},Re=function(e){var t=e.inferredDate,n=e.startEndList,i=e.playlistSettings,c=e.setActiveKey,l=Object(a.useState)({prefix:"fcs",cameraView:"chorus",nextIndex:1,indexOffset:0}),o=Object(s.a)(l,2),u=o[0],d=o[1],j=Object(a.useState)({}),b=Object(s.a)(j,2),f=(b[0],b[1]);return Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(Ae,{playlistSettings:i,value:u,setValue:d}),Object(w.jsx)(Ve,{inferredDate:t,startEndList:n,playlistSettings:i,videoNaming:u,setVideoResources:f}),Object(w.jsx)(je.a,{disabled:!0,children:"Upload no work"}),function(){var e={Body:{style:{width:"auto"}}};return xe()?i.id?null:Object(w.jsxs)(fe.a,{kind:Oe.a.negative,overrides:e,children:["Please \xa0",Object(w.jsx)(ae.a,{onClick:function(){return c(2)},children:"find or create the playlist"}),"\xa0 first"]}):Object(w.jsxs)(fe.a,{kind:Oe.a.negative,overrides:e,children:["Please \xa0",Object(w.jsx)(ae.a,{onClick:function(){return c(1)},children:"authenticate"}),"\xa0 first"]})}()]})},Le=new h.a;var Pe=function(){var e=Object(a.useState)(0),t=Object(s.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),c=Object(s.a)(i,2),h=c[0],v=c[1],m=Object(a.useState)({eventType:"rehearsal"}),g=Object(s.a)(m,2),y=g[0],T=g[1],S=Object(a.useState)({}),C=Object(s.a)(S,2),D=C[0],k=C[1],E=Object(a.useState)({titleChoice:"suggested"}),I=Object(s.a)(E,2),A=I[0],V=I[1],R=Object(a.useState)({}),L=Object(s.a)(R,2),P=L[0],F=L[1];return Object(w.jsx)(O.a,{value:Le,children:Object(w.jsx)(u.a,{theme:d.a,children:Object(w.jsxs)(j.b,{theme:Object(b.a)(f.a,{colors:{inputTextDisabled:"black"}}),children:[Object(w.jsx)(re.b,{children:Object(w.jsxs)(x.a,{activeKey:n,onChange:function(e){var t=e.activeKey;return r(t)},children:[Object(w.jsx)(p.a,{title:"Files",children:Object(w.jsx)(oe,{startEndList:h,setStartEndList:v,rehearsalData:y,setRehearsalData:T,inferredDate:P,setInferredDate:F})}),Object(w.jsx)(p.a,{title:"Auth",children:Object(w.jsx)(pe,{})}),Object(w.jsx)(p.a,{title:"Playlist",children:Object(w.jsx)(we,{startEndList:h,rehearsalData:y,setRehearsalData:T,inferredDate:P,setActiveKey:r,playlistTitle:A,setPlaylistTitle:V,value:D,setValue:k})}),Object(w.jsx)(p.a,{title:"Videos",children:Object(w.jsx)(Re,{inferredDate:P,startEndList:h,playlistSettings:D,setActiveKey:r})})]})}),Object(w.jsx)("footer",{children:Object(w.jsx)("p",{children:Object(w.jsxs)("a",{href:"https://github.com/kamatsuoka/playlister",children:[Object(w.jsx)(l.a,{className:"fa-padded",icon:o.a,size:"lg"}),"GitHub"]})})})]})})})};n(95);c.a.render(Object(w.jsx)(Pe,{}),document.getElementById("root"))}},[[96,1,2]]]);
//# sourceMappingURL=main.96a42f68.chunk.js.map